// Code is generated by github.com/swaggest/swac <version>, do not edit. ðŸ¤–

/**
 * USPTO Data Set API
 * Version: 1.0.0
 * The Data Set API (DSAPI) allows the public users to discover and search
 * USPTO exported data sets. This is a generic API that allows USPTO users to
 * make any CSV based data files searchable through API. With the help of GET
 * call, it returns the list of data fields that are searchable. With the help
 * of POST call, data can be fetched based on the filters on the field names.
 * Please note that POST call is used to search the actual data. The reason
 * for the POST call is that it allows users to specify any complex search
 * criteria without worry about the GET size limitations as well as encoding
 * of the input parameters.
 * @constructor
 * @param {string} baseURL - Base URL.
 * @property {PrepareRequest} prepareRequest - Callback to prepare request before sending.
 */
function APIClient(baseURL) {
    // Trim trailing backslash.
    this.baseURL = (baseURL.charAt(baseURL.length - 1) === '/') ? baseURL.slice(0, -1) : baseURL;
}

/**
 * @callback PrepareRequest
 * @param {XMLHttpRequest} value
 */

/**
 * List available data sets
 * @param {object} req - request parameters.
 * @param {DataSetListCallback} onOK
 */
APIClient.prototype.listDataSets = function (req, onOK) {
    var x = new XMLHttpRequest();
    x.onreadystatechange = function () {
        if (x.readyState !== XMLHttpRequest.DONE) {
            return
        }
    
        switch (x.status) {
            case 200:
                if (typeof(onOK) == 'function') {
                    onOK(JSON.parse(x.responseText));
                }
                break;
            default:
                throw {err: 'unexpected response', data: x}
        }
    };
    
    var url = this.baseURL + '/?';
    url = url.slice(0, -1)

    x.open("GET", url, true);
    if (typeof(this.prepareRequest) == 'function') {
        this.prepareRequest(x);
    }
    
    x.send();
}

/**
 * Provides the general information about the API and the list of fields that can be used to query the dataset.
 * This GET API returns the list of all the searchable field names that are in
 * the oa_citations. Please see the 'fields' attribute which returns an array
 * of field names. Each field or a combination of fields can be searched using
 * the syntax options shown below.
 * @param {GetDatasetVersionFieldsRequest} req - request parameters.
 * @param {StringCallback} onOK
 * @param {StringCallback} onNotFound
 */
APIClient.prototype.getDatasetVersionFields = function (req, onOK, onNotFound) {
    var x = new XMLHttpRequest();
    x.onreadystatechange = function () {
        if (x.readyState !== XMLHttpRequest.DONE) {
            return
        }
    
        switch (x.status) {
            case 200:
                if (typeof(onOK) == 'function') {
                    onOK(JSON.parse(x.responseText));
                }
                break;
            case 404:
                if (typeof(onNotFound) == 'function') {
                    onNotFound(JSON.parse(x.responseText));
                }
                break;
            default:
                throw {err: 'unexpected response', data: x}
        }
    };
    
    var url = this.baseURL + '/' + encodeURIComponent(req.dataset) +
    '/' + encodeURIComponent(req.version) +
    '/fields?';
    url = url.slice(0, -1)

    x.open("GET", url, true);
    if (typeof(this.prepareRequest) == 'function') {
        this.prepareRequest(x);
    }
    
    x.send();
}

/**
 * Provides search capability for the data set with the given search criteria.
 * This API is based on Solr/Lucense Search. The data is indexed using SOLR.
 * This GET API returns the list of all the searchable field names that are in
 * the Solr Index. Please see the 'fields' attribute which returns an array of
 * field names. Each field or a combination of fields can be searched using
 * the Solr/Lucene Syntax. Please refer
 * https://lucene.apache.org/core/3_6_2/queryparsersyntax.html#Overview for
 * the query syntax. List of field names that are searchable can be determined
 * using above GET api.
 * @param {PostDatasetVersionRecordsRequest} req - request parameters.
 * @param {ArrayObjectStringObjectCallback} onOK
 * @param {RawCallback} onNotFound
 */
APIClient.prototype.postDatasetVersionRecords = function (req, onOK, onNotFound) {
    var x = new XMLHttpRequest();
    x.onreadystatechange = function () {
        if (x.readyState !== XMLHttpRequest.DONE) {
            return
        }
    
        switch (x.status) {
            case 200:
                if (typeof(onOK) == 'function') {
                    onOK(JSON.parse(x.responseText));
                }
                break;
            case 404:
                if (typeof(onNotFound) == 'function') {
                    onNotFound(x);
                }
                break;
            default:
                throw {err: 'unexpected response', data: x}
        }
    };
    
    var url = this.baseURL + '/' + encodeURIComponent(req.dataset) +
    '/' + encodeURIComponent(req.version) +
    '/records?';
    url = url.slice(0, -1)

    x.open("POST", url, true);
    if (typeof(this.prepareRequest) == 'function') {
        this.prepareRequest(x);
    }
    var formData = ''
    if (typeof req.criteria !== 'undefined') {
        formData += 'criteria=' + encodeURIComponent(req.criteria) + '&'
    }
    if (typeof req.start !== 'undefined') {
        formData += 'start=' + encodeURIComponent(req.start) + '&'
    }
    if (typeof req.rows !== 'undefined') {
        formData += 'rows=' + encodeURIComponent(req.rows) + '&'
    }

    if (formData !== '') {
        x.setRequestHeader("Content-Type", "application/x-www-form-urlencoded");
        x.send(formData.slice(0, -1))
        return  
    }

    x.send();
}

